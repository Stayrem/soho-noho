var owl;function filterSlides(){$(".appartments__filter").on("click",".appartments__filter-item",function(){var e=$(this);$(".appartments__filter-item").removeClass("active"),$(this).addClass("active");var t=e.data("owl-filter");owl.owlcarousel2_filter(t),$(".owl-carousel").trigger("to.owl.carousel",1)})}function validateSubscription(){var e=document.querySelector(".subscribe__form input"),t=document.getElementById("error-user-email"),l=document.querySelector(".subscribe__submit");if(null!=l){l.addEventListener("click",function(){t.style.display=r(e.value)?"none":"block",r(e.value)&&subscribeAjaxSender()}),l.addEventListener("click",function(){});var a=/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/;function r(e){return a.test(e)}}}function subscribeAjaxSender(){var e="https://api.unisender.com/ru/api/subscribe?format=json&api_key=6ymtxf34uo6gteook3g653g9j7s7hedhs7kwp36a&list_ids=17947745&fields[email]=";$(function(){var t=$(this);$.ajax({type:"POST",url:e+$(".subscribe__form").find("input").val(),data:t.serialize()}).done(function(){$("#confirm-email").slideDown(),$("#error-user-email").slideUp(),$("#fail-email").slideUp()}).fail(function(){$("#fail-email").slideDown(),$("#confirm-email").slideUp(),$("#error-user-email").slideUp()}),console.log(e+$(".subscribe__form").find("input").val())})}function mobileScrollTo(){$(".header-mobile__btn").on("click",function(){$([document.documentElement,document.body]).animate({scrollTop:$(".grid").offset().top},800)})}function sendData(e,t){var l,a,r;t?(l=$("#name-modal").val(),a=$("#phone-modal").val(),r=$("#email-modal").val()):(l=$("#name").val(),a=$("#phone").val(),r=$("#email").val()),$.ajax({url:"/send_mail.php",method:"POST",data:{name:l,phone:a,email:r},beforeSend:function(){switchLoading(e,1)},error:function(t){switchLoading(e,0),showResponseMessage(e,"danger")},success:function(l){switchLoading(e,0),showResponseMessage(e,"success"),$("input").val(""),t&&document.querySelector(".dwn-link").click()}})}function showResponseMessage(e,t){"danger"===t?(e.find(".fail").css({display:"block"}),e.find(".success").css({display:"none"})):"success"===t&&(e.find(".fail").css({display:"none"}),e.find(".success").css({display:"block"}))}function switchLoading(e,t){1===t?e.find("button").addClass("loading"):e.find("button").removeClass("loading")}function sortMeiaGallery(){if(null!=document.querySelector(".grid-gallery")){for(var e,t=window.location.toString(),l=t.length;l>=0;l--)"#"===t[l]&&(e=l);var a=decodeURI(t.slice(e+1));"view"===a&&setTimeout(function(){$(".gallery__list-item:nth-child(2) button").click()},500),"interior"===a&&setTimeout(function(){$(".gallery__list-item:nth-child(3) button").click()},500)}}function initLightGallery(){$(document).ready(function(){$(".styles__right").lightGallery()}),$(document).ready(function(){$(".grid-gallery").lightGallery({selector:".grid-gallery a"})})}function initPopup(){$(".pdf").magnificPopup({removalDelay:500,callbacks:{beforeOpen:function(){this.st.mainClass=this.st.el.attr("data-effect")}},midClick:!0})}function animateImage(){if($(".tilter.tilter--1").length>0){var e={movement:{imgWrapper:{translation:{x:10,y:10,z:30},rotation:{x:0,y:-10,z:0},reverseAnimation:{duration:200,easing:"easeOutQuad"}},lines:{translation:{x:10,y:10,z:[0,70]},rotation:{x:0,y:0,z:-2},reverseAnimation:{duration:2e3,easing:"easeOutExpo"}},caption:{rotation:{x:0,y:0,z:2},reverseAnimation:{duration:200,easing:"easeOutQuad"}},overlay:{translation:{x:10,y:-10,z:0},rotation:{x:0,y:0,z:2},reverseAnimation:{duration:2e3,easing:"easeOutExpo"}},shine:{translation:{x:100,y:100,z:0},reverseAnimation:{duration:200,easing:"easeOutQuad"}}}};new TiltFx(document.querySelectorAll(".tilter.tilter--1")[0],e),new TiltFx(document.querySelectorAll(".tilter.tilter--1")[1],e)}}function galleryFilterInit(){$(".gallery__list-link").on("click",function(){$(".gallery__list-link").removeClass("active"),$(this).addClass("active");var e=this.getAttribute("rel");"group1"===e?($(".grid-gallery-item a").removeClass("active"),$(".group2,.group3").animate({opacity:0},300,function(){$(".group2,.group3").css({display:"none"}),$(".group1").css({display:"block",opacity:"1"}),$(".grid-gallery").masonry(),$(".group1 a").addClass("active"),$(document).ready(function(){$(".grid-gallery").lightGallery({selector:".grid-gallery a.active"})})})):"group2"===e?($(".grid-gallery-item a").removeClass("active"),$(".group1,.group3").animate({opacity:0},300,function(){$(".group1,.group3").css({display:"none"}),$(".group2").css({display:"block",opacity:"1"}),$(".grid-gallery").masonry(),$(".group2 a").addClass("active"),$(document).ready(function(){$(".grid-gallery").lightGallery({selector:".grid-gallery a.active"})})})):"group3"===e?($(".grid-gallery-item a").removeClass("active"),$(".group2,.group1").animate({opacity:0},300,function(){$(".group2,.group1").css({display:"none"}),$(".group3").css({display:"block",opacity:"1"}),$(".grid-gallery").masonry(),$(".group3 a").addClass("active"),$(document).ready(function(){$(".grid-gallery").lightGallery({selector:".grid-gallery a.active"})})})):($(".group1,.group3,.group2").css({display:"block",opacity:"1"}),$(".grid-gallery").masonry(),$(document).ready(function(){$(".grid-gallery").lightGallery({selector:".grid-gallery a"})}))})}function moveToForm(){$(".toform").on("click",function(){$([document.documentElement,document.body]).animate({scrollTop:$(".form-wrapper").offset().top},1500),$(".input-name").focus()})}function setPhoneMask(){null!=document.querySelector(".bfh-phone")&&($(function(){$(".bfh-phone").mask("+7(999) 999-99-99")}),document.querySelector(".bfh-phone").addEventListener("focus",function(){moveCaretToStart(this)})),null!=document.querySelector("#phone-modal")&&($(function(){$("#phone-modal").mask("+7(999) 999-99-99")}),document.querySelector("#phone-modal").addEventListener("focus",function(){moveCaretToStart(this)}))}function moveCaretToStart(e){if(e.createTextRange){var t=e.createTextRange();t.collapse(!0),t.select()}}function moveCaretToEnd(e){if(e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}}function moveCaretToStart(e){e.selectionStart&&(e.setSelectionRange(0,0),e.focus())}function moveCaretToEnd(e){if(e.selectionStart){var t=e.value.length;e.setSelectionRange(t,t),e.focus()}}function formValidator(){$(".form").validate({rules:{name:{required:!0,minlength:3},email:{required:!0,email:!0},tel:{required:!0,minlength:10}},submitHandler:function(){sendData($(this),!1)}}),$(".popup-form").validate({rules:{name:{required:!0,minlength:3},email:{required:!0,email:!0},tel:{required:!0,minlength:10}},submitHandler:function(){sendData($(this),!0)}})}function scrollAmimationInit(){AOS.init({disable:!1,startEvent:"DOMContentLoaded",initClassName:"aos-init",animatedClassName:"aos-animate",useClassNames:!1,disableMutationObserver:!1,debounceDelay:50,throttleDelay:99,offset:120,delay:0,duration:400,easing:"ease",once:!1,mirror:!1,anchorPlacement:"top-bottom"})}function onePageScrollInit(){$(window).width()>992&&$.scrollify({section:".page-scroll",sectionName:"section-name",interstitialSection:".page-scroll--half",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:!0,standardScrollElements:"",setHeights:!0,overflowScroll:!0,updateHash:!0,touchScroll:!0,scrollBar:!1,before:function(){},after:function(){},afterResize:function(){},afterRender:function(){}})}function masonryGalleryMaker(){var e=$(".grid-gallery").masonry({itemSelector:".grid-gallery-item",percentPosition:!0,columnWidth:".grid-sizer"});e.imagesLoaded().progress(function(){e.masonry()})}function openMobileMenu(){$("#nav-icon1,#nav-icon2,#nav-icon3,#nav-icon4").click(function(){$(this).toggleClass("open"),$(".mobile-menu").toggleClass("mobile-menu--open")})}function setAppartmentSlider(){(owl=$(".owl-carousel").owlCarousel({loop:!1,margin:10,nav:!0,autoWidth:!0,center:!0,nav:!1,responsive:{0:{items:1},600:{items:3},1000:{items:3}}})).on("translated.owl.carousel",function(e){setSliderBtns()})}function appsFilterBtnEvent(){$(".appartments__filter-item").click(function(){var e=this.getAttribute("data-filter-slider"),t=document.querySelectorAll(".appartments__slider .owl-item .slide-item"),l=0;for(let a=0;a<t.length&&l<=0;a++)t[a].classList.contains(e)&&(console.log(t[a]),console.log(a),$(".owl-carousel").trigger("to.owl.carousel",a),l++)})}function setSliderBtns(){$(".appartments__filter-item").removeClass("active");var e=$(".appartments__slider .owl-item.active.center .slide-item");e.hasClass("double")?$(".appartments__filter-item:nth-child(1)").addClass("active"):e.hasClass("tripple")?$(".appartments__filter-item:nth-child(2)").addClass("active"):e.hasClass("quadro")?($(".appartments__filter-item:nth-child(3)").addClass("active"),console.log("quadro")):e.hasClass("penthaus")&&$(".appartments__filter-item:nth-child(4)").addClass("active")}function initItemMap(){if(null!=document.querySelector(".map")){markerImage="../img/@2x/placeholder.png";var e={lat:55.785985,lng:37.585859},t={lat:55.785567,lng:37.565926};$(window).width()<1200&&(t={lat:55.79179,lng:37.587001}),$(window).width()<768&&(t={lat:55.788703,lng:37.585827}),l=new google.maps.Map(document.querySelector(".map"),{center:t,scrollwheel:!1,zoom:15,disableDefaultUI:!0,styles:[{elementType:"geometry",stylers:[{color:"#212121"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#212921"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"transit.station",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#292c3a"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}]}),new google.maps.Marker({position:e,map:l,icon:markerImage})}if(null!=document.querySelector(".front__map")){markerImage="https://newflat.nikaestate.ru/wp-content/uploads/2019/05/marker-new.png";e={lat:55.764139,lng:37.60063};var l=new google.maps.Map(document.querySelector(".front__map"),{center:e,scrollwheel:!1,zoom:15,disableDefaultUI:!0,styles:[{elementType:"geometry",stylers:[{color:"#212121"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#212921"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"transit.station",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#292c3a"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}]});new google.maps.Marker({position:e,map:l,icon:markerImage})}}function changerValidateMessage(){jQuery.extend(jQuery.validator.messages,{required:"Это поле обязательно для ввода",remote:"Please fix this field.",email:"Неправильный email адрес",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Неправильный формат",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:jQuery.validator.format("Please enter no more than {0} characters."),minlength:jQuery.validator.format("Вы ввели меньше {0} символов."),rangelength:jQuery.validator.format("Please enter a value between {0} and {1} characters long."),range:jQuery.validator.format("Please enter a value between {0} and {1}."),max:jQuery.validator.format("Please enter a value less than or equal to {0}."),min:jQuery.validator.format("Please enter a value greater than or equal to {0}.")})}document.addEventListener("DOMContentLoaded",function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),l=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let a=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),a.unobserve(t)}})});e.forEach(function(e){a.observe(e)});let r=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(e.target.classList.add("visible"),r.unobserve(e.target))})});t.forEach(function(e){r.observe(e)});let o=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",o.unobserve(t)}})});l.forEach(function(e){o.observe(e)})}else e.forEach(function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset}),t.forEach(function(e){e.classList.add("visible")}),l.forEach(function(e){e.style.backgroundImage="url("+e.dataset.bg+")"})}),document.addEventListener("DOMContentLoaded",function(){initItemMap(),setAppartmentSlider(),setSliderBtns(),openMobileMenu(),masonryGalleryMaker(),scrollAmimationInit(),appsFilterBtnEvent(),animateImage(),formValidator(),changerValidateMessage(),setPhoneMask(),moveToForm(),galleryFilterInit(),sortMeiaGallery(),initPopup(),mobileScrollTo(),$(".owl-carousel").trigger("to.owl.carousel",1),validateSubscription(),filterSlides(),$(".appartments__filter-item:first-child").click()}),window.onload=function(){initLightGallery()};